(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,o=window.wp.blockEditor,r=JSON.parse('{"UU":"comintel-business/project-container"}'),c=window.lodash,n=window.wp.element,s=window.wp.url,i=window.wp.data,l=window.wp.apiFetch;var a=e.n(l);const p=window.wp.components,u=window.ReactJSXRuntime;(0,t.registerBlockType)(r.UU,{edit:function({attributes:e,setAttributes:r,clientId:l}){const d=(0,o.useBlockProps)(),{insertBlock:w}=(0,i.useDispatch)("core/block-editor"),{lockPostSaving:j,unlockPostSaving:k}=(0,i.useDispatch)("core/editor"),{createErrorNotice:b}=(0,i.useDispatch)("core/notices"),h=(0,i.useSelect)((e=>e("core/editor").getCurrentPostId()),[]),v=(0,i.useSelect)((e=>e("core/block-editor").getBlock(l)),[]),m=e=>{const t=v.innerBlocks?.map((e=>e.attributes.project)),o=e?.map((e=>{const o=!!e?.value&&(0,c.includes)(t,e.value+"");return{...e,disabled:!!o}}));r({projects:o})};return(0,n.useEffect)((()=>{const t=v.innerBlocks?.map((e=>e.attributes.project));m(e.projects),0===t?.length||t?.length>0&&!t.includes("")?k("projectlock"):(j("projectlock"),b("Please select at least one project. You can't save this post until you select a project or remove it.",{type:"snackbar",icon:"‼️",isDismissible:!0,id:"project-error-notice"}))}),[v.innerBlocks]),(0,n.useEffect)((()=>{(async()=>{const e=await a()({path:(0,s.addQueryArgs)("/project/v1/show-projects",{curr_post_id:h})}),t=e.results?.map((e=>({value:e.id,label:e.title})));m([{value:"",label:"Select Project"}].concat(t))})()}),[h]),(0,u.jsxs)("div",{...d,children:[(0,u.jsx)(o.InnerBlocks,{renderAppender:!1}),(0,u.jsx)(p.Button,{disabled:v.innerBlocks.length>=6,variant:"primary",onClick:()=>{w((0,t.createBlock)("comintel-business-component/project-list",{project:""}),v.innerBlocks.length,l)},children:"Tambah Referensi Project"})]})},save:function({attributes:e}){const t=o.useBlockProps.save();return(0,u.jsx)(n.Fragment,{...t,children:(0,u.jsx)(o.InnerBlocks.Content,{})})}})})();